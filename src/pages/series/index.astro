---
import BaseLayout from '@/layouts/BaseLayout.astro';
import Breadcrumb from '@/components/common/Breadcrumb.astro';
import { url } from '@/lib/utils';
import { getAllSeries, getPostsBySeries } from '@/lib/content';

const seriesList = getAllSeries();
const seriesWithCount = await Promise.all(
  seriesList.map(async (s) => {
    const posts = await getPostsBySeries(s.slug);
    return { ...s, count: posts.length };
  })
);
---

<BaseLayout title="シリーズ一覧" description="シリーズ一覧ページ">
  <div class="mx-auto max-w-6xl px-4 py-8">
    <Breadcrumb items={[{ label: 'シリーズ一覧' }]} />
    <h1 class="mb-8 text-3xl font-bold text-(--color-text-primary)">シリーズ一覧</h1>
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {seriesWithCount.map((s) => (
        <a
          href={url(`/series/${s.slug}`)}
          class="group rounded-xl border border-(--color-border) bg-(--color-bg-primary) p-6 transition-shadow hover:shadow-lg"
        >
          <h2 class="text-xl font-bold text-(--color-text-primary) group-hover:text-zinc-900 dark:group-hover:text-zinc-100 transition-colors">
            {s.name}
          </h2>
          {s.description && (
            <p class="mt-2 text-sm text-(--color-text-secondary)">{s.description}</p>
          )}
          <p class="mt-3 text-sm text-(--color-text-tertiary)">{s.count}件の記事</p>
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
